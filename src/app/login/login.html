<div class="login-container">
  <div class="login-wrapper">
    <!-- Left Panel - Branding -->
    <div class="login-branding">
      <div class="brand-logo">
        <i class="fas fa-industry"></i>
      </div>
      <h1 class="brand-title">Raw Material E-Portal</h1>
      <p class="brand-subtitle">Material Requisition Management System</p>
      
      <div class="features-list">
        <div class="feature-item">
          <i class="fas fa-check-circle"></i>
          <span>Secure Authentication</span>
        </div>
        <div class="feature-item">
          <i class="fas fa-check-circle"></i>
          <span>Multi-User Roles</span>
        </div>
        <div class="feature-item">
          <i class="fas fa-check-circle"></i>
          <span>Cloud Sync</span>
        </div>
        <div class="feature-item">
          <i class="fas fa-check-circle"></i>
          <span>Real-time Updates</span>
        </div>
      </div>
    </div>

    <!-- Right Panel - Login Form -->
    <div class="login-form-panel">
      <div class="form-header">
        <h2>Sign In to Your Account</h2>
        <p>Enter your credentials to access the system</p>
      </div>

      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form" #loginFormElement>
        <!-- Username/Email Field -->
        <div class="form-group">
          <label for="username">
            <i class="fas fa-user"></i> Username or Email
          </label>
          <div class="input-group">
            <input
              type="text"
              id="username"
              formControlName="username"
              class="form-control"
              placeholder="Enter your username or email"
              [class.is-invalid]="usernameControl?.invalid && usernameControl?.touched"
              [class.is-valid]="usernameControl?.valid && usernameControl?.touched"
              [attr.disabled]="isLoading ? true : null"
            >
            <div class="input-icon">
              <i class="fas fa-user-circle"></i>
            </div>
          </div>
          @if (usernameControl?.invalid && usernameControl?.touched) {
            <div class="invalid-feedback">
              @if (usernameControl?.errors?.['required']) {
                <div><i class="fas fa-exclamation-circle"></i> Username or email is required</div>
              }
              @if (usernameControl?.errors?.['minlength']) {
                <div><i class="fas fa-exclamation-circle"></i> Must be at least 3 characters</div>
              }
            </div>
          }
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <label for="password">
            <i class="fas fa-lock"></i> Password
          </label>
          <div class="input-group">
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="password"
              formControlName="password"
              class="form-control"
              placeholder="Enter your password"
              [class.is-invalid]="passwordControl?.invalid && passwordControl?.touched"
              [class.is-valid]="passwordControl?.valid && passwordControl?.touched"
              [attr.disabled]="isLoading ? true : null"
            >

            <button 
              type="button" 
              class="toggle-password"
              (click)="togglePasswordVisibility()"
              [title]="showPassword ? 'Hide password' : 'Show password'"
              [disabled]="isLoading"
            >
              <i class="fas" [class.fa-eye-slash]="showPassword" [class.fa-eye]="!showPassword"></i>
            </button>
          </div>
          @if (passwordControl?.invalid && passwordControl?.touched) {
            <div class="invalid-feedback">
              @if (passwordControl?.errors?.['required']) {
                <div><i class="fas fa-exclamation-circle"></i> Password is required</div>
              }
              @if (passwordControl?.errors?.['minlength']) {
                <div><i class="fas fa-exclamation-circle"></i> Password is too short</div>
              }
            </div>
          }
        </div>

        <!-- Remember Me & Forgot Password -->
        <div class="form-options">
          <div class="form-check">
            <input 
              type="checkbox" 
              id="rememberMe" 
              formControlName="rememberMe" 
              class="form-check-input"
              [attr.disabled]="isLoading ? true : null"
            >
            <label for="rememberMe" class="form-check-label">Remember me</label>
          </div>
          <a href="#" class="forgot-password" [class.disabled]="isLoading">Forgot password?</a>
        </div>

        <!-- Error Message -->
        @if (errorMessage) {
          <div class="alert alert-danger fade-in" @fadeInOut>
            <i class="fas fa-exclamation-triangle"></i> {{ errorMessage }}
          </div>
        }

        <!-- Success Message -->
        @if (successMessage) {
          <div class="alert alert-success fade-in" @fadeInOut>
            <i class="fas fa-check-circle"></i> {{ successMessage }}
            <div class="spinner-small"></div>
          </div>
        }

        <!-- Submit Button -->
        <button 
          type="submit" 
          class="btn-login"
          [disabled]="loginForm.invalid || isLoading"
          [class.loading]="isLoading"
        >
          @if (isLoading) {
            <span class="spinner"></span>
            Signing in...
          } @else {
            <i class="fas fa-sign-in-alt"></i> Sign In
          }
        </button>

        <!-- Debug info (remove in production) -->
        <div class="debug-info" *ngIf="false">
          <p>isLoading: {{isLoading}}</p>
          <p>errorMessage: {{errorMessage}}</p>
          <p>successMessage: {{successMessage}}</p>
        </div>

      </form>
    </div>
  </div>
</div>